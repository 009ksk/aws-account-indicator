# AWS Account Indicator

複数のAWSアカウントを使用する際に、現在どのアカウントにログインしているかを視覚的に識別できるChrome拡張機能です。

## 主な機能

### 🎨 ウォーターマーク表示
- **アカウント名ウォーターマーク**: 画面上にアカウント名をウォーターマークとして表示
- **ドラッグ可能**: 画面内の任意の位置に移動可能
- **位置の自動保存**: 移動した位置は自動的に保存され、次回訪問時に復元
- **透明度・サイズ調整**: ウォーターマークの透明度とフォントサイズをカスタマイズ可能

### 🔧 柔軟な設定
- **表形式の設定画面**: アカウント番号、表示名、色を一行で簡単設定
- **カスタム色設定**: 各アカウントに個別の背景色を設定
- **自動テキスト色調整**: 背景色に応じて見やすいテキスト色を自動選択
- **設定のエクスポート/インポート**: 設定の共有やバックアップが可能

### 🌐 幅広い対応
- **AWS Management Console**: 通常のAWSコンソール
- **AWS SSO (Identity Center)**: SSOログイン環境
- **スイッチロール**: 異なるアカウント間のロール切り替え

## インストール方法

### 開発版のインストール

1. このリポジトリをクローンまたはダウンロード
```bash
git clone https://github.com/yourusername/aws-account-indicator.git
cd aws-account-indicator
```

2. Chromeで`chrome://extensions/`にアクセス

3. 右上の「デベロッパーモード」を有効化

4. 「パッケージ化されていない拡張機能を読み込む」をクリック

5. ダウンロードしたフォルダを選択

### アイコンの準備

拡張機能を完全に動作させるには、`icons`フォルダに以下のファイルを配置してください：

- `icon16.png` (16x16px)
- `icon48.png` (48x48px) 
- `icon128.png` (128x128px)

## 使い方

### 基本設定

1. 拡張機能のアイコンをクリックしてポップアップを開く
2. 「詳細設定」ボタンをクリックして設定画面を開く

3. 「アカウント追加」ボタンで新しいアカウントを追加

4. 以下の情報を入力：
   - **アカウント番号**: 12桁のAWSアカウント番号（ハイフン区切りも対応）
   - **表示名**: 分かりやすい名前（例：「本番環境」「開発環境」）- 最大25文字
   - **背景色**: ウォーターマークに適用する色

5. 💾ボタンで設定を保存

### クイック設定

現在AWSコンソールにログインしている場合：

1. 設定画面上部の「このアカウントを設定」ボタンをクリック
2. アカウント番号が自動入力されるので、名前と色を設定
3. 保存

### ウォーターマークの操作

- **移動**: ウォーターマークをドラッグして好きな位置に移動
- **位置の保存**: 移動した位置は自動的に保存され、次回訪問時に復元
- **画面内制限**: ウォーターマークは画面外に出ないよう制限されます

### グローバル設定

- **ウォーターマーク表示**: アカウント名の表示ON/OFF
- **透明度**: ウォーターマークの透明度を10%〜100%で調整
- **フォントサイズ**: ウォーターマークのフォントサイズを24px〜72pxで調整

## 対応環境

### AWSサービス
- AWS Management Console (全サービス)
- AWS SSO/Identity Center
- スイッチロール環境

### ブラウザ
- Google Chrome (Manifest V3対応)
- Chromium系ブラウザ

### 検出方法
拡張機能は以下の方法でアカウント情報を検出します：

1. **DOM要素からの抽出**: ページ内のアカウント情報を検索
2. **URLパラメータからの解析**: URLに含まれるアカウント情報を解析

## 設定の管理

### エクスポート
設定画面の「エクスポート」ボタンでJSON形式でダウンロード

### インポート
「インポート」ボタンで既存の設定ファイルを読み込み

### 一括操作
- **全選択/選択解除**: 複数のアカウント設定を一括選択
- **一括削除**: 選択したアカウント設定を一括削除

### 検索機能
- アカウント番号または表示名で検索
- リアルタイムフィルタリング

### 危険な操作
- **設定リセット**: すべての設定を初期化
- **ストレージクリア**: すべてのローカルデータを削除

## トラブルシューティング

### アカウントが検出されない
1. ページを再読み込み
2. AWSコンソールに完全にログインしているか確認
3. URLが対応サイトに含まれているか確認

### ウォーターマークが表示されない
1. グローバル設定でウォーターマーク表示が有効か確認
2. ページを再読み込み
3. アカウントが正しく設定されているか確認

### ウォーターマークが移動できない
1. ウォーターマークが正しく表示されているか確認
2. ブラウザのポインターイベントが有効か確認

## 開発者向け情報

### ファイル構成
```
aws-account-indicator/
├── manifest.json          # 拡張機能の設定
├── content.js             # AWSページで実行されるスクリプト
├── content.css            # ウォーターマーク用スタイル
├── popup.html             # ポップアップ画面のHTML
├── popup.js               # ポップアップ画面のロジック
├── popup.css              # ポップアップ画面のスタイル
├── options.html           # 詳細設定画面のHTML
├── options.js             # 詳細設定画面のロジック
├── options.css            # 詳細設定画面のスタイル
├── background.js          # バックグラウンドスクリプト
├── icons/                 # アイコンファイル
└── README.md              # このファイル
```

### 主要クラス

#### `AWSAccountIndicator` (content.js)
- アカウント情報の検出
- ウォーターマークの表示・制御
- ドラッグ機能の実装

#### `OptionsManager` (options.js)  
- 詳細設定画面の管理
- アカウント設定のCRUD操作
- エクスポート/インポート機能
- グローバル設定の管理

#### `BackgroundManager` (background.js)
- 拡張機能のライフサイクル管理
- 基本的なメッセージング

### カスタマイズ

#### 新しいAWS URLパターンの追加
`manifest.json`の`content_scripts.matches`に追加：

```json
"matches": [
  "https://*.amazonaws.com/*",
  "https://*.aws.amazon.com/*",
  "https://your-custom-aws-domain.com/*"
]
```

#### アカウント検出ロジックの拡張
`content.js`の`getAccountNumberFromDOM()`メソッドに新しいセレクタを追加：

```javascript
const selectors = [
  // 既存のセレクタ...
  '.your-custom-selector',
  '[data-your-attribute]'
];
```

#### ウォーターマークスタイルのカスタマイズ
`content.css`の`.aws-account-watermark`クラスを編集：

```css
.aws-account-watermark {
  /* カスタムスタイル */
}
```

## ライセンス

MIT License - 詳細は[LICENSE](LICENSE)ファイルを参照
